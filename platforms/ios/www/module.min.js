"use strict";function getVisibleMinutes(a,b){a=new Date(a||new Date),a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours());for(var c=[],d=a.getTime()+36e5;a.getTime()<d;)c.push(a),a=new Date(a.getTime()+60*b*1e3);return c}function getVisibleWeeks(a){a=new Date(a||new Date),a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),0===a.getDay()?a.setDate(-5):a.setDate(a.getDate()-(a.getDay()-1)),1===a.getDate()&&a.setDate(-6);for(var b=[];b.length<6;){for(var c=[],d=0;7>d;d++)c.push(new Date(a)),a.setDate(a.getDate()+1);b.push(c)}return b}function getVisibleYears(a){var b=[];a=new Date(a||new Date),a.setFullYear(a.getFullYear()-a.getFullYear()%10);for(var c=0;12>c;c++)b.push(new Date(a.getFullYear()+(c-1),0,1));return b}function getDaysOfWeek(a){a=new Date(a||new Date),a=new Date(a.getFullYear(),a.getMonth(),a.getDate()),a.setDate(a.getDate()-(a.getDay()-1));for(var b=[],c=0;7>c;c++)b.push(new Date(a)),a.setDate(a.getDate()+1);return b}function getVisibleMonths(a){a=new Date(a||new Date);for(var b=a.getFullYear(),c=[],d=0;12>d;d++)c.push(new Date(b,d,1));return c}function getVisibleHours(a){a=new Date(a||new Date),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);for(var b=[],c=0;24>c;c++)b.push(a),a=new Date(a.getTime()+36e5);return b}var Module=angular.module("datePicker",[]);Module.constant("datePickerConfig",{template:"templates/datepicker.html",view:"month",views:["year","month","date","hours","minutes"],step:5}),Module.directive("datePicker",function(a){return{template:'<div ng-include="template"></div>',scope:{model:"=datePicker",after:"=?",before:"=?"},link:function(b,c,d){function e(){var a=b.view,c=b.date;switch(a){case"year":b.years=getVisibleYears(c);break;case"month":b.months=getVisibleMonths(c);break;case"date":b.weekdays=b.weekdays||getDaysOfWeek(),b.weeks=getVisibleWeeks(c);break;case"hours":b.hours=getVisibleHours(c);break;case"minutes":b.minutes=getVisibleMinutes(c,g)}}function f(){return"date"!==b.view?b.view:b.model?b.model.getMonth():null}b.date=new Date(b.model||new Date),b.views=a.views.concat(),b.view=d.view||a.view,b.now=new Date,b.template=d.template||a.template;var g=parseInt(d.step||a.step,10);b.views=b.views.slice(b.views.indexOf(d.maxView||"year"),b.views.indexOf(d.minView||"minutes")+1),(1===b.views.length||-1===b.views.indexOf(b.view))&&(b.view=b.views[0]),b.setView=function(a){-1!==b.views.indexOf(a)&&(b.view=a)},b.setDate=function(a){b.date=a;var c=b.views[b.views.indexOf(b.view)+1];if(!c||b.model){switch(b.model=new Date(b.model||a),b.view){case"minutes":b.model.setMinutes(a.getMinutes());case"hours":b.model.setHours(a.getHours());case"date":b.model.setDate(a.getDate());case"month":b.model.setMonth(a.getMonth());case"year":b.model.setFullYear(a.getFullYear())}b.$emit("setDate",b.model,b.view)}c&&b.setView(c)},b.$watch(f,e),b.next=function(a){var c=b.date;switch(a=a||1,b.view){case"year":case"month":c.setFullYear(c.getFullYear()+a);break;case"date":c.setMonth(c.getMonth()+a);break;case"hours":case"minutes":c.setHours(c.getHours()+a)}e()},b.prev=function(a){return b.next(-a||-1)},b.isAfter=function(a){return b.after?b.after.getTime()<=a.getTime():!1},b.isBefore=function(a){return b.before?b.before.getTime()>=a.getTime():!1},b.isSameMonth=function(a){return b.isSameYear(a)&&b.model.getMonth()===a.getMonth()},b.isSameYear=function(a){return b.model?b.model.getFullYear()===a.getFullYear():!1},b.isSameDay=function(a){return b.isSameMonth(a)&&b.model.getDate()===a.getDate()},b.isSameHour=function(a){return b.isSameDay(a)&&b.model.getHours()===a.getHours()},b.isSameMinutes=function(a){return b.isSameHour(a)&&b.model.getMinutes()===a.getMinutes()},b.isNow=function(a){var c=!0,d=b.now;switch(b.view){case"minutes":c&=~~(a.getMinutes()/g)===~~(d.getMinutes()/g);case"hours":c&=a.getHours()===d.getHours();case"date":c&=a.getDate()===d.getDate();case"month":c&=a.getMonth()===d.getMonth();case"year":c&=a.getFullYear()===d.getFullYear()}return c}}}});var Module=angular.module("datePicker");Module.directive("dateRange",function(){return{templateUrl:"templates/daterange.html",scope:{start:"=",end:"="},link:function(a){a.$watch("start.getTime()",function(b){b&&a.end&&b>a.end.getTime()&&(a.end=new Date(b))}),a.$watch("end.getTime()",function(b){b&&a.start&&b<a.start.getTime()&&(a.start=new Date(b))})}}});var PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",Module=angular.module("datePicker");Module.constant("dateTimeConfig",{template:function(a){return'<div date-picker="'+a.ngModel+'" '+(a.view?'view="'+a.view+'" ':"")+(a.maxView?'max-view="'+a.maxView+'" ':"")+(a.template?'template="'+a.template+'" ':"")+(a.minView?'min-view="'+a.minView+'" ':"")+'class="dropdown-menu"></div>'},format:"yyyy-MM-dd HH:mm",views:["date","year","month","hours","minutes"],dismiss:!1,position:"relative"}),Module.directive("dateTimeAppend",function(){return{link:function(a,b){b.bind("click",function(){b.find("input")[0].focus()})}}}),Module.directive("dateTime",function(a,b,c,d,e){var f=b.find("body"),g=c("date");return{require:"ngModel",scope:!0,link:function(b,c,h,i){function j(a){return g(a,o)}function k(){return i.$modelValue}function l(a){a.stopPropagation(),i.$pristine&&(i.$dirty=!0,i.$pristine=!1,c.removeClass(PRISTINE_CLASS).addClass(DIRTY_CLASS),p&&p.$setDirty(),i.$render())}function m(){u&&(u.remove(),u=null),w&&(w.remove(),w=null)}function n(){if(!u){if(u=a(x)(b),b.$digest(),b.$on("setDate",function(a,b,c){l(a),t&&q[q.length-1]===c&&m()}),b.$on("$destroy",m),"absolute"===v){var d=angular.extend(c.offset(),{height:c[0].offsetHeight});u.css({top:d.top+d.height,left:d.left,display:"block",position:v}),f.append(u)}else w=angular.element("<div date-picker-wrapper></div>"),c[0].parentElement.insertBefore(w[0],c[0]),w.append(u),u.css({top:c[0].offsetHeight+"px",display:"block"});u.bind("mousedown",function(a){a.preventDefault()})}}var o=h.format||d.format,p=c.inheritedData("$formController"),q=e(h.views)(b)||d.views.concat(),r=h.view||q[0],s=q.indexOf(r),t=h.dismiss?e(h.dismiss)(b):d.dismiss,u=null,v=h.position||d.position,w=null;-1===s&&q.splice(s,1),q.unshift(r),i.$formatters.push(j),i.$parsers.unshift(k);var x=d.template(h);c.bind("focus",n),c.bind("blur",m)}}});